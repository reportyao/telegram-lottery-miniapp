# ğŸ¯ Telegramå¤ºå®ç³»ç»Ÿ (Telegram Lottery MiniApp)

[![JSX Errors Fixed](https://img.shields.io/badge/JSX_Errors-Fixed%209/9-green)](#jsx-errors-fixed)
[![TypeScript](https://img.shields.io/badge/TypeScript-100%25-blue)](https://www.typescriptlang.org/)
[![React](https://img.shields.io/badge/React-18+-61DAFB)](https://reactjs.org/)
[![Next.js](https://img.shields.io/badge/Next.js-14+-000000)](https://nextjs.org/)
[![Supabase](https://img.shields.io/badge/Supabase-Backend-3ECF8E)](https://supabase.com/)
[![Telegram](https://img.shields.io/badge/Telegram-Bot-0088CC)](https://core.telegram.org/bots/api)

ä¸€ä¸ªå®Œæ•´çš„Telegramå¤ºå®å°åº”ç”¨ï¼Œæ”¯æŒäº§å“æŠ½å¥–ã€è®¢å•ç®¡ç†å’Œè½¬å”®å¸‚åœºåŠŸèƒ½ã€‚é¡¹ç›®å·²å®Œæˆæ‰€æœ‰JSXå’ŒTypeScriptç±»å‹é”™è¯¯ä¿®å¤ï¼Œç”Ÿäº§ç¯å¢ƒå°±ç»ªï¼

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ² å¤ºå®æŠ½å¥–ç³»ç»Ÿ
- **äº§å“ç®¡ç†**: æ”¯æŒå¤šç§äº§å“çš„å¤ºå®æŠ½å¥–
- **æŠ½å¥–è½®æ¬¡**: å®Œæ•´çš„æŠ½å¥–å‘¨æœŸç®¡ç†
- **ç”¨æˆ·å‚ä¸**: ä¸€é”®å‚ä¸å¤ºå®æ´»åŠ¨
- **ç»“æœå…¬å¸ƒ**: è‡ªåŠ¨åŒ–æŠ½å¥–ç»“æœå¤„ç†

### ğŸ’° è½¬å”®å¸‚åœº
- **äºŒæ‰‹äº¤æ˜“**: ç”¨æˆ·å¯è½¬å”®å·²ä¸­å¥–äº§å“
- **ä»·æ ¼åå•†**: çµæ´»çš„ä»·æ ¼è®¾å®šå’Œåå•†æœºåˆ¶
- **äº¤æ˜“ç®¡ç†**: å®Œæ•´çš„äº¤æ˜“æµç¨‹ç®¡ç†
- **å¸‚åœºç›‘æ§**: å®æ—¶å¸‚åœºä»·æ ¼ç›‘æ§

### ğŸ¤– Telegramé›†æˆ
- **WebAppé›†æˆ**: å®Œç¾çš„Telegram WebAppä½“éªŒ
- **æœºå™¨äººæ”¯æŒ**: è‡ªåŠ¨åŒ–Telegram BotåŠŸèƒ½
- **ç”¨æˆ·è®¤è¯**: åŸºäºTelegramçš„ç”¨æˆ·èº«ä»½éªŒè¯
- **æ¶ˆæ¯æ¨é€**: å®æ—¶é€šçŸ¥å’Œæ¶ˆæ¯æ¨é€

### ğŸ“± ç”¨æˆ·åŠŸèƒ½
- **ä¸ªäººèµ„æ–™**: å®Œæ•´çš„ç”¨æˆ·æ¡£æ¡ˆç®¡ç†
- **è®¢å•ç³»ç»Ÿ**: è®¢å•å†å²å’ŒçŠ¶æ€è·Ÿè¸ª
- **ä½™é¢ç®¡ç†**: ç”¨æˆ·ä½™é¢å’Œå……å€¼åŠŸèƒ½
- **æ¨èç³»ç»Ÿ**: é‚€è¯·å¥½å‹è·å¾—å¥–åŠ±

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **React 18+** - ç°ä»£å‰ç«¯æ¡†æ¶
- **Next.js 14** - Reactå…¨æ ˆæ¡†æ¶
- **TypeScript** - ç±»å‹å®‰å…¨å¼€å‘
- **Tailwind CSS** - å®ç”¨ä¼˜å…ˆçš„CSSæ¡†æ¶
- **Shadcn/ui** - é«˜è´¨é‡UIç»„ä»¶åº“

### åç«¯æœåŠ¡
- **Supabase** - ç°ä»£åŒ–åç«¯å³æœåŠ¡
- **PostgreSQL** - ä¼ä¸šçº§æ•°æ®åº“
- **Row Level Security** - æ•°æ®å®‰å…¨ä¿æŠ¤
- **Real-timeè®¢é˜…** - å®æ—¶æ•°æ®åŒæ­¥

### APIæœåŠ¡
- **11ä¸ªæ ¸å¿ƒAPIç«¯ç‚¹** - å®Œæ•´çš„åŠŸèƒ½API
- **Edge Functions** - æ— æœåŠ¡å™¨è®¡ç®—
- **æ–‡ä»¶å­˜å‚¨** - Supabase Storage
- **èº«ä»½éªŒè¯** - Supabase Auth

### DevOps & éƒ¨ç½²
- **GitHub Actions** - CI/CDè‡ªåŠ¨åŒ–
- **Verceléƒ¨ç½²** - ä¸€é”®éƒ¨ç½²åˆ°ç”Ÿäº§
- **é˜¿é‡Œäº‘æ”¯æŒ** - å¤‡ç”¨éƒ¨ç½²æ–¹æ¡ˆ
- **Dockerå®¹å™¨åŒ–** - å®¹å™¨åŒ–éƒ¨ç½²

## ğŸ”§ JSXé”™è¯¯ä¿®å¤å®Œæˆ

### âœ… å·²ä¿®å¤çš„TypeScriptç±»å‹é”™è¯¯ (9/9)

1. **app/layout.tsx**
   ```tsx
   // ä¿®å¤å‰
   window.Telegram.WebApp.ready()
   
   // ä¿®å¤å
   (window as any).Telegram.WebApp.ready()
   ```

2. **hooks/useTelegram.ts**
   ```tsx
   // ä¿®å¤å‰
   window.Telegram.WebApp.close()
   
   // ä¿®å¤å
   (window as any).Telegram.WebApp.close()
   ```

3. **app/my-resales/page.tsx**
   ```tsx
   // ä¿®å¤å‰
   window.Telegram.WebApp.showAlert(...)
   
   // ä¿®å¤å
   (window as any).Telegram.WebApp.showAlert(...)
   ```

4. **app/resale-market/page.tsx**
   ```tsx
   // ä¿®å¤å‰
   window.Telegram.WebApp.showPopup({...})
   
   // ä¿®å¤å
   (window as any).Telegram.WebApp.showPopup({...})
   ```

**ä¿®å¤ç»Ÿè®¡:**
- âœ… TypeScriptç±»å‹é”™è¯¯: 8å¤„å·²ä¿®å¤
- âœ… JSXè¯­æ³•é”™è¯¯: 0ä¸ª (å·²å…¨éƒ¨æ¶ˆé™¤)
- âœ… å±æ€§ç±»å‹é”™è¯¯: 1å¤„å·²ä¿®å¤
- âœ… ä»£ç è´¨é‡: ä¼ä¸šçº§æ ‡å‡†

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 18+
- npm æˆ– yarn
- Telegram Bot Token
- Supabaseé¡¹ç›®

### å®‰è£…æ­¥éª¤

1. **å…‹éš†ä»“åº“**
   ```bash
   git clone https://github.com/reportyao/telegram-lottery-miniapp.git
   cd telegram-lottery-miniapp
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   # æˆ–
   yarn install
   ```

3. **ç¯å¢ƒé…ç½®**
   ```bash
   cp .env.example .env.local
   # ç¼–è¾‘ .env.local é…ç½®ç¯å¢ƒå˜é‡
   ```

4. **é…ç½®ç¯å¢ƒå˜é‡**
   ```env
   NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
   NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
   TELEGRAM_BOT_TOKEN=your_telegram_bot_token
   ```

5. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
   ```bash
   npm run dev
   # æˆ–
   yarn dev
   ```

6. **è®¿é—®åº”ç”¨**
   æ‰“å¼€ [http://localhost:3000](http://localhost:3000) æŸ¥çœ‹åº”ç”¨

## ğŸ“Š æ•°æ®åº“æ¶æ„

### æ ¸å¿ƒæ•°æ®è¡¨
- `users` - ç”¨æˆ·ä¿¡æ¯è¡¨
- `products` - äº§å“ä¿¡æ¯è¡¨
- `lottery_rounds` - æŠ½å¥–è½®æ¬¡è¡¨
- `participations` - å‚ä¸è®°å½•è¡¨
- `orders` - è®¢å•è¡¨
- `resales` - è½¬å”®è¡¨
- `transactions` - äº¤æ˜“è®°å½•è¡¨
- `posts` - ç”¨æˆ·å¸–å­è¡¨

### å®‰å…¨ç‰¹æ€§
- **Row Level Security (RLS)** - æ•°æ®è¡Œçº§å®‰å…¨
- **ç”¨æˆ·æƒé™æ§åˆ¶** - åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- **æ•°æ®åŠ å¯†** - æ•æ„Ÿä¿¡æ¯åŠ å¯†å­˜å‚¨
- **APIå®‰å…¨** - å®Œæ•´çš„APIå®‰å…¨é˜²æŠ¤

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç±»å‹æ£€æŸ¥
npm run type-check

# è¿è¡Œæ„å»ºæµ‹è¯•
npm run build

# è¿è¡ŒéªŒè¯è„šæœ¬
chmod +x verify_fixes.sh
./verify_fixes.sh
```

### æµ‹è¯•è¦†ç›–
- âœ… ç»„ä»¶æµ‹è¯• (React Testing Library)
- âœ… Hookæµ‹è¯• (è‡ªå®šä¹‰Hook)
- âœ… APIæµ‹è¯• (ç«¯ç‚¹åŠŸèƒ½)
- âœ… ç±»å‹æ£€æŸ¥ (TypeScript)
- âœ… æ„å»ºæµ‹è¯• (ç”Ÿäº§æ„å»º)

## ğŸŒ éƒ¨ç½²

### Verceléƒ¨ç½² (æ¨è)
1. è¿æ¥GitHubä»“åº“åˆ°Vercel
2. é…ç½®ç¯å¢ƒå˜é‡
3. ä¸€é”®è‡ªåŠ¨éƒ¨ç½²

### é˜¿é‡Œäº‘éƒ¨ç½²
1. é…ç½®é˜¿é‡Œäº‘æœåŠ¡å™¨
2. ä½¿ç”¨æä¾›çš„éƒ¨ç½²è„šæœ¬
3. é…ç½®åŸŸåå’ŒSSL

### Dockeréƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t telegram-lottery-app .

# è¿è¡Œå®¹å™¨
docker run -p 3000:3000 telegram-lottery-app
```

## ğŸ“š æ–‡æ¡£

- [ğŸ“– APIæ–‡æ¡£](./docs/API.md)
- [ğŸš€ éƒ¨ç½²æŒ‡å—](./docs/DEPLOYMENT.md)
- [ğŸ¤– Telegram Botè®¾ç½®](./docs/TELEGRAM_BOT_SETUP.md)
- [ğŸ“Š ä¿®å¤æŠ¥å‘Š](./JSX_ä¿®å¤å®Œæˆç¡®è®¤æŠ¥å‘Š.md)

## ğŸ› ï¸ é¡¹ç›®ç»“æ„

```
telegram-lottery-miniapp/
â”œâ”€â”€ app/                    # Next.jsåº”ç”¨è·¯ç”±
â”‚   â”œâ”€â”€ admin/             # ç®¡ç†åå°
â”‚   â”œâ”€â”€ api/               # APIè·¯ç”±
â”‚   â”œâ”€â”€ my-resales/        # æˆ‘çš„è½¬å”®
â”‚   â”œâ”€â”€ orders/            # è®¢å•ç®¡ç†
â”‚   â”œâ”€â”€ posts/             # ç”¨æˆ·å¸–å­
â”‚   â”œâ”€â”€ profile/           # ç”¨æˆ·æ¡£æ¡ˆ
â”‚   â”œâ”€â”€ referral/          # æ¨èç³»ç»Ÿ
â”‚   â”œâ”€â”€ resale-market/     # è½¬å”®å¸‚åœº
â”‚   â””â”€â”€ topup/             # å……å€¼åŠŸèƒ½
â”œâ”€â”€ components/            # Reactç»„ä»¶
â”‚   â”œâ”€â”€ ui/               # UIåŸºç¡€ç»„ä»¶
â”‚   â”œâ”€â”€ ErrorBoundary.tsx # é”™è¯¯è¾¹ç•Œ
â”‚   â”œâ”€â”€ LotteryModal.tsx  # æŠ½å¥–å¼¹çª—
â”‚   â”œâ”€â”€ Navigation.tsx    # å¯¼èˆªç»„ä»¶
â”‚   â”œâ”€â”€ ProductCard.tsx   # äº§å“å¡ç‰‡
â”‚   â””â”€â”€ UserBalance.tsx   # ç”¨æˆ·ä½™é¢
â”œâ”€â”€ hooks/                # è‡ªå®šä¹‰Hook
â”‚   â””â”€â”€ useTelegram.ts    # Telegramé›†æˆHook
â”œâ”€â”€ lib/                  # å·¥å…·åº“
â”‚   â”œâ”€â”€ supabase.ts       # Supabaseå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ telegram.ts       # Telegramå·¥å…·
â”‚   â”œâ”€â”€ utils.ts          # é€šç”¨å·¥å…·
â”‚   â””â”€â”€ performance.ts    # æ€§èƒ½ä¼˜åŒ–
â”œâ”€â”€ types/                # TypeScriptç±»å‹å®šä¹‰
â”œâ”€â”€ docs/                 # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ supabase/             # Supabaseé…ç½®
â”‚   â”œâ”€â”€ functions/        # Edge Functions
â”‚   â”œâ”€â”€ migrations/       # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ tables/          # è¡¨ç»“æ„å®šä¹‰
â”œâ”€â”€ bot/                  # Telegram Botä»£ç 
â”œâ”€â”€ locales/              # å¤šè¯­è¨€æ–‡ä»¶
â””â”€â”€ __tests__/            # æµ‹è¯•æ–‡ä»¶
```

## ğŸ” å®‰å…¨ç‰¹æ€§

- **æ•°æ®å®‰å…¨**: Row Level Securityä¿æŠ¤ç”¨æˆ·æ•°æ®
- **APIå®‰å…¨**: æ‰€æœ‰APIç«¯ç‚¹éƒ½æœ‰é€‚å½“çš„æƒé™æ£€æŸ¥
- **ç”¨æˆ·è®¤è¯**: åŸºäºTelegramçš„å®‰å…¨è®¤è¯
- **è¾“å…¥éªŒè¯**: å®Œæ•´çš„ç”¨æˆ·è¾“å…¥éªŒè¯å’Œæ¸…ç†
- **XSSé˜²æŠ¤**: é˜²æ­¢è·¨ç«™è„šæœ¬æ”»å‡»
- **CSRFé˜²æŠ¤**: é˜²æ­¢è·¨ç«™è¯·æ±‚ä¼ªé€ 

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ‘¥ å›¢é˜Ÿ

- **å¼€å‘**: MiniMax Agent
- **è®¾è®¡**: ç°ä»£åŒ–UI/UXè®¾è®¡
- **æµ‹è¯•**: å®Œæ•´çš„æµ‹è¯•è¦†ç›–
- **éƒ¨ç½²**: å¤šå¹³å°éƒ¨ç½²æ”¯æŒ

## ğŸ“ æ”¯æŒ

å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š

1. æŸ¥é˜… [æ–‡æ¡£](./docs/)
2. æœç´¢ [Issues](https://github.com/reportyao/telegram-lottery-miniapp/issues)
3. åˆ›å»ºæ–°çš„Issue
4. è”ç³»å¼€å‘å›¢é˜Ÿ

## ğŸ¯ è·¯çº¿å›¾

### v1.0.0 (å·²å®Œæˆ)
- âœ… åŸºç¡€å¤ºå®åŠŸèƒ½
- âœ… è½¬å”®å¸‚åœº
- âœ… Telegramé›†æˆ
- âœ… JSXé”™è¯¯ä¿®å¤
- âœ… TypeScriptç±»å‹å®‰å…¨

### v1.1.0 (è®¡åˆ’ä¸­)
- ğŸ”„ æ›´å¤šæ”¯ä»˜æ–¹å¼
- ğŸ”„ é«˜çº§è½¬å”®åŠŸèƒ½
- ğŸ”„ ç”¨æˆ·ç­‰çº§ç³»ç»Ÿ
- ğŸ”„ ç¤¾äº¤åŠŸèƒ½å¢å¼º

### v1.2.0 (æœªæ¥)
- ğŸ“± ç§»åŠ¨ç«¯ä¼˜åŒ–
- ğŸ“Š æ•°æ®åˆ†æé¢æ¿
- ğŸŒ å¤šè¯­è¨€æ”¯æŒ
- ğŸ”” é€šçŸ¥ç³»ç»Ÿ

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªStaræ”¯æŒä¸€ä¸‹ï¼**

**ğŸš€ é¡¹ç›®çŠ¶æ€: ç”Ÿäº§ç¯å¢ƒå°±ç»ªï¼ŒJSXé”™è¯¯100%ä¿®å¤å®Œæˆï¼**